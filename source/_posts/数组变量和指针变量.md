---
title: 数组变量和指针变量
author: Portgas·D·Asce
categories:
  - [C/C++]
tags:
  - C语言
date: 2020-10-09 01:45:49
---
数组变量 和 指针变量 在使用的时候真的是太像了，本文将对这两者内容进行深入分析。
<!--more-->

## 1 数组
首先理解两个东西：int \*a[3] 和 int (\*a)[3]
- **int \*a[3]**： a 是一个长度为 3 的数组，其中元素为 int \* 类型的指针变量；
- **int (\*a)[3]** : a 是一个指针，指向一个 长度为 3 的一维数组；

ps：**int \*a[3]** 理解起来很简单，不是重点； **int (\*a)[3]** 才是重头戏！！！

### 1.1 一维数组
```c
int a[] = {1, 2, 3, 4, 5};
int *p = a;

//error
//a = p;
```
p 和 a 在使用的时候真的很像：
- p 和 a 都表示数组中第一个元素的地址（即，a[0] 和 p[0] 都表示数组中第一个元素）；
- a + 1 和 p + 1 都表示数组中第二个元素的地址（即，\*(a + 1) 和 \*(p + 1) 都表示数组中第二个元素）；

但是，只是用起来像而已：
- p： 是一个指针变量；
- a： 是一个数组变量；

先来回忆一下 & 取地址运算符：a[0]，表示数组中第一个元素，对其取地址 &a[0] 就是数组中第一个元素的地址， &a[0] + 1 表示数组中第二个元素的地址（这和 a、p 是一模一样的）。

那 &a 又表示什么呢？ 
- &a 是对数组变量 a 取地址，也就是： &a 是一个指针，指向一个数组；
- 在一开始已经说过了 int (*x)[3] 中的 x 表示一个指针，指向 一个长度为 3 的数组； 显然，&a 的本质就是这么个东西；

已经知道 &a 是一个指针，指向一个数组，那 &a + 1 又表示什么呢？
- &a 通常被称作 **数组的地址** ，而非数组中第一个元素的地址；
- &a + 1 不是数组中第二个元素的地址，而是整个数组的尾地址（最后一个元素后面那个地址）；

补充两点：
- sizeof(a) 表示整个数组所占的字节数；
- 数组传递到形参后会退化为指针；

实验代码及结果：
```c
#include <stdio.h>

int main() {
    int a[5] = {1, 2, 3, 4, 5};
    printf("a = %p\n", a);
    printf("a + 1 = %p\n", a + 1);
    printf("&a = %p\n", &a);
    printf("&a[0] = %p\n", &a[0]);
    printf("&a[1] = %p\n", &a[1]);
    printf("a + 1 = %p\n", a + 1);
    printf("&a[0] + 1 = %p\n", &a[0] + 1);
    printf("&a + 1 = %p\n", &a + 1);
    printf("*a = %d\n", *a);
    return 0;
}

//输出
a = 0x7ffcfc26d500
a + 1 = 0x7ffcfc26d504
&a = 0x7ffcfc26d500
&a[0] = 0x7ffcfc26d500
&a[1] = 0x7ffcfc26d504
a + 1 = 0x7ffcfc26d504
&a[0] + 1 = 0x7ffcfc26d504
&a + 1 = 0x7ffcfc26d514
*a = 1
```

### 1.2 二维数组
```c
int a[2][3] = {{1, 2, 3},{4， 5, 6}};
```
\[\] 取地址运算符，结合方向是从左到右：
- 先将 a\[2\] 看作一个整体；
- 剩下 int a[2][3] 可以理解为：声明了一个长度为 3 的数组，数组名为 a[2]；
- a[2] 又是一个数组；

上面解释得确实有点牵强哈，总之，有以下结论：
- a 是一个长度为 2 的数组，其中元素均为长度为 3 的数组；也就是说 a 是 数组的数组；

a 是二维数组的数组名，它代表什么呢？
- 对于一维数组，数组名的含义是：数组中第一个元素的地址；二维数组也是一样的；
- 因此，a 是二维数组中第一个元素（第一个长度为 3 的数组）的地址；这不就是 指向数组的指针；
- 于是，a + 1 指向二维数组中第二个元素（第二个长度为 3 的数组）也就不难理解了；

a[0],a[1]又该如何理解呢？
- a[0]：二维数组 a 的第一个长度为 3 的数组的数组名；
- a[1]：二维数组 a 的第二个长度为 3 的数组的数组名；

&a 表示对二维数组取地址，这又该如何理解呢？
- &a 可以这样来理解：还是对一个一维数组取地址，只不过这个一维数组中的元素还是数组（而不是 int 类型变量）;
- 按道理说 &a + 1 应该是二维数组 a 的尾地址；但实际上 &a + 1 是会报错的；

结合以上两点内容，就不难理解：对于一个多维数组 a[x][y]...[m]
- &a, a, &a[0], a[0], &a[0][0], a[0][0], &a[0][0][0]...[0]虽然它们的含义是不同的，但是的它们的值（地址）都是相等的，都是这个多维数组的地址；


实验代码及结果
```c
#include <stdio.h>

int main() {
    int a[][3] = {{1, 2, 3},{4, 5, 6}};
    printf("a = %p\n", a);
    printf("&a = %p\n", &a);
    printf("a + 1 = %p\n", a + 1);
    //printf("&a + 1 = %p\n" &a + 1);

    printf("a[0] = %p\n", a[0]);
    printf("a[0] + 1 = %p\n", a[0] + 1);
    printf("&a[0] = %p\n", &a[0]);
    printf("&a[0] + 1 = %p\n", &a[0] + 1);

    printf("a[1] = %p\n", a[1]);
    printf("a[1] + 1 = %p\n", a[1] + 1);
    printf("&a[1] = %p\n", &a[1]);
    printf("&a[1] + 1 = %p\n", &a[1] + 1);

    printf("a[0][0] = %d\n", a[0][0]);
    printf("&a[0][0] = %p\n", &a[0][0]);
    printf("&a[0][0] + 1 = %p\n", &a[0][0] + 1);
    printf("&a[0][1] = %p\n", &a[0][1]);

    printf("a[1][0] = %d\n", a[1][0]);
    printf("&a[1][0] = %p\n", &a[1][0]);
    printf("&a[1][0] + 1 = %p\n", &a[1][0] + 1);
    printf("&a[1][1] = %p\n", &a[1][1]);

    return 0;
}

//输出
a = 0x7ffd5a756830
&a = 0x7ffd5a756830
a + 1 = 0x7ffd5a75683c
a[0] = 0x7ffd5a756830
a[0] + 1 = 0x7ffd5a756834
&a[0] = 0x7ffd5a756830
&a[0] + 1 = 0x7ffd5a75683c
a[1] = 0x7ffd5a75683c
a[1] + 1 = 0x7ffd5a756840
&a[1] = 0x7ffd5a75683c
&a[1] + 1 = 0x7ffd5a756848
a[0][0] = 1
&a[0][0] = 0x7ffd5a756830
&a[0][0] + 1 = 0x7ffd5a756834
&a[0][1] = 0x7ffd5a756834
a[1][0] = 4
&a[1][0] = 0x7ffd5a75683c
&a[1][0] + 1 = 0x7ffd5a756840
&a[1][1] = 0x7ffd5a756840
```
## 2 指针
